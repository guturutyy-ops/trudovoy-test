<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Квест: Основы трудового права</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Сброс и базовые стили */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #6b4226 0%, #8B4513 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        /* Основной контейнер */
        .container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            perspective: 1200px;
        }

        /* ЖУРНАЛ (обложка) */
        .journal-cover {
            width: 100%;
            height: auto;
            min-height: 600px;
            background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.5s ease;
        }

        @media (max-width: 768px) {
            .journal-cover {
                padding: 30px 20px;
                min-height: 500px;
            }
        }

        .journal-cover.hidden {
            display: none !important;
        }

        .journal-cover:hover {
            transform: scale(1.02);
        }

        .journal-cover::before {
            content: '';
            position: absolute;
            top: 15px;
            right: 15px;
            bottom: 15px;
            left: 15px;
            border: 3px solid rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            pointer-events: none;
        }

        /* ЗОЛОТАЯ ПЕЧАТЬ В ЦЕНТРЕ */
        .seal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 4px solid #f1c40f;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            opacity: 0.1;
            pointer-events: none;
        }

        .seal i {
            font-size: 3.5rem;
            color: #f1c40f;
            margin-bottom: 10px;
        }

        .seal-text {
            font-size: 0.9rem;
            font-weight: bold;
            color: #f1c40f;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .journal-cover h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.4);
            z-index: 2;
            position: relative;
        }

        @media (max-width: 768px) {
            .journal-cover h1 {
                font-size: 1.8rem;
                flex-direction: column;
                text-align: center;
            }
        }

        .journal-cover h1 i {
            font-size: 2.8rem;
            color: #f1c40f;
            filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.3));
        }

        @media (max-width: 768px) {
            .journal-cover h1 i {
                font-size: 2.2rem;
            }
        }

        .journal-cover .subtitle {
            font-size: 1.3rem;
            margin-bottom: 30px;
            opacity: 0.9;
            font-style: italic;
            max-width: 700px;
            line-height: 1.6;
            z-index: 2;
            position: relative;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 768px) {
            .journal-cover .subtitle {
                font-size: 1.1rem;
                padding: 0 10px;
            }
        }

        .journal-cover .author {
            font-size: 1.2rem;
            margin-bottom: 40px;
            color: #f1c40f;
            font-weight: bold;
            z-index: 2;
            position: relative;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 768px) {
            .journal-cover .author {
                font-size: 1rem;
                margin-bottom: 30px;
            }
        }

        /* БЛОКИ НА ОБЛОЖКЕ */
        .features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0 40px;
            max-width: 700px;
            z-index: 2;
            position: relative;
        }

        @media (max-width: 768px) {
            .features {
                grid-template-columns: 1fr;
                gap: 15px;
                margin: 25px 0;
            }
        }

        .feature {
            padding: 20px;
            background: rgba(255, 255, 255, 0.12);
            border-radius: 10px;
            backdrop-filter: blur(8px);
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        @media (max-width: 768px) {
            .feature {
                padding: 15px;
            }
        }

        .feature:hover {
            transform: translateY(-8px);
            background: rgba(255, 255, 255, 0.18);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .feature i {
            font-size: 2rem;
            color: #f1c40f;
            margin-bottom: 12px;
            filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.2));
        }

        .feature h3 {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: white;
            font-weight: 600;
        }

        .feature p {
            font-size: 0.9rem;
            opacity: 0.9;
            line-height: 1.5;
            color: rgba(255, 255, 255, 0.9);
        }

        .start-button {
            margin-top: 20px;
            padding: 16px 45px;
            font-size: 1.3rem;
            background: linear-gradient(135deg, #f1c40f 0%, #ffd700 100%);
            color: #8B4513;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            z-index: 2;
            position: relative;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        @media (max-width: 768px) {
            .start-button {
                padding: 14px 35px;
                font-size: 1.1rem;
            }
        }

        .start-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.4);
            background: linear-gradient(135deg, #ffd700 0%, #f1c40f 100%);
        }

        /* СТРАНИЦЫ ЖУРНАЛА */
        .journal-page {
            display: none;
            background: #FFFEF0;
            height: 850px; /* Увеличена высота страниц */
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            animation: pageFlip 0.6s ease-out;
        }

        @media (max-width: 768px) {
            .journal-page {
                height: 95vh;
                max-height: 850px;
                margin: 0 auto;
            }
        }

        @media (max-height: 900px) {
            .journal-page {
                height: 90vh;
            }
        }

        .journal-page.active {
            display: flex;
            flex-direction: column;
        }

        @keyframes pageFlip {
            from {
                opacity: 0;
                transform: rotateY(-90deg) translateX(-80px);
            }
            to {
                opacity: 1;
                transform: rotateY(0) translateX(0);
            }
        }

        /* Эффект линованной бумаги */
        .journal-page::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(transparent 39px, rgba(139, 69, 19, 0.07) 1px);
            background-size: 100% 40px;
            pointer-events: none;
            z-index: 1;
        }

        /* Шапка страницы */
        .page-header {
            padding: 30px 40px 20px;
            border-bottom: 3px solid #D2B48C;
            position: relative;
            z-index: 2;
            background: rgba(255, 254, 240, 0.95);
            min-height: 140px;
        }

        @media (max-width: 768px) {
            .page-header {
                padding: 25px 25px 20px;
                min-height: 120px;
            }
        }

        .page-number {
            position: absolute;
            top: 20px;
            right: 35px;
            background: #8B4513;
            color: #f1c40f;
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: bold;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .page-number {
                right: 25px;
                top: 15px;
            }
        }

        .page-title {
            font-size: 2rem;
            color: #8B4513;
            margin-bottom: 10px;
            font-family: 'Georgia', serif;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .page-title {
                font-size: 1.6rem;
                margin-top: 10px;
            }
        }

        .page-subtitle {
            color: #666;
            font-style: italic;
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .page-subtitle {
                font-size: 1rem;
            }
        }

        /* Контент страницы - теперь больше места */
        .page-content {
            flex: 1;
            padding: 0 40px 25px;
            overflow-y: auto;
            position: relative;
            z-index: 2;
            max-height: 630px; /* Увеличена максимальная высота контента */
        }

        @media (max-width: 768px) {
            .page-content {
                padding: 0 25px 20px;
                max-height: 580px;
            }
        }

        .entry-date {
            display: inline-block;
            background: #8B4513;
            color: white;
            padding: 6px 18px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 20px;
            font-weight: bold;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .entry-text {
            line-height: 1.7;
            font-size: 1.2rem;
            color: #333;
            margin-bottom: 25px;
            text-align: justify;
            padding-right: 10px;
        }

        @media (max-width: 768px) {
            .entry-text {
                font-size: 1.1rem;
            }
        }

        /* Ситуационные блоки */
        .situation-box {
            background: rgba(210, 180, 140, 0.15);
            border-left: 4px solid #A0522D;
            padding: 25px;
            margin: 30px 0;
            border-radius: 0 10px 10px 0;
            position: relative;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
        }

        @media (max-width: 768px) {
            .situation-box {
                padding: 20px;
                margin: 25px 0;
            }
        }

        .situation-box h3 {
            color: #8B4513;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
        }

        @media (max-width: 768px) {
            .situation-box h3 {
                font-size: 1.2rem;
            }
        }

        /* Задания */
        .task-container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin: 35px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 2px solid #E8D0B3;
            position: relative;
        }

        @media (max-width: 768px) {
            .task-container {
                padding: 25px;
                margin: 30px 0;
            }
        }

        .task-title {
            color: #8B4513;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.4rem;
        }

        @media (max-width: 768px) {
            .task-title {
                font-size: 1.3rem;
                margin-bottom: 20px;
            }
        }

        /* НОВОЕ ЗАДАНИЕ 2: СОПОСТАВЛЕНИЕ СТАТЕЙ ТК РФ */
        .matching-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
        }

        .matching-pair {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #E8D0B3;
            transition: all 0.3s;
        }

        @media (max-width: 768px) {
            .matching-pair {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }

        .matching-pair:hover {
            background: #f0f7ff;
            border-color: #3498db;
            transform: translateX(5px);
        }

        .matching-situation {
            flex: 2;
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.05rem;
            line-height: 1.4;
        }

        .matching-select {
            flex: 1;
            padding: 10px 15px;
            border: 3px solid #dee2e6;
            border-radius: 6px;
            background: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            min-width: 200px;
        }

        @media (max-width: 768px) {
            .matching-select {
                width: 100%;
                min-width: auto;
            }
        }

        .matching-select:focus {
            outline: none;
            border-color: #8B4513;
            box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1);
        }

        .matching-select.correct {
            border-color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
        }

        .matching-select.incorrect {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        /* НОВОЕ ЗАДАНИЕ 5: КОНСТРУКТОР ТРУДОВОГО ДОГОВОРА */
        .contract-builder {
            margin: 25px 0;
        }

        .contract-clause {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .contract-clause:hover {
            border-color: #3498db;
            box-shadow: 0 3px 8px rgba(52, 152, 219, 0.1);
        }

        .contract-clause.active {
            border-color: #27ae60;
            background: rgba(39, 174, 96, 0.05);
        }

        .contract-clause.incorrect {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.05);
        }

        .clause-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .clause-status {
            font-size: 0.9rem;
            padding: 3px 10px;
            border-radius: 12px;
            background: #e9ecef;
            color: #6c757d;
        }

        .clause-status.correct {
            background: #d4edda;
            color: #155724;
        }

        .clause-status.incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        .clause-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .clause-option {
            padding: 12px 15px;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
        }

        .clause-option:hover {
            background: #e9ecef;
            border-color: #adb5bd;
        }

        .clause-option.selected {
            background: rgba(52, 152, 219, 0.15);
            border-color: #3498db;
            color: #2980b9;
        }

        .clause-option.correct {
            background: rgba(39, 174, 96, 0.15);
            border-color: #27ae60;
            color: #27ae60;
        }

        .clause-option.incorrect {
            background: rgba(231, 76, 60, 0.15);
            border-color: #e74c3c;
            color: #e74c3c;
        }

        .contract-preview {
            background: white;
            border: 3px solid #8B4513;
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .contract-line {
            margin-bottom: 5px;
            padding: 2px 0;
        }

        .contract-line.highlight {
            background: rgba(139, 69, 19, 0.1);
            padding: 5px 10px;
            border-radius: 4px;
        }

        /* DRAG & DROP */
        .drag-drop-container {
            margin: 30px 0;
        }

        @media (max-width: 768px) {
            .drag-drop-container {
                margin: 25px 0;
            }
        }

        .drag-drop-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 25px 0;
        }

        @media (max-width: 768px) {
            .drag-drop-area {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        .drag-source, .drag-target {
            border: 2px dashed #D2B48C;
            border-radius: 10px;
            padding: 25px;
            min-height: 250px;
        }

        @media (max-width: 768px) {
            .drag-source, .drag-target {
                min-height: 220px;
            }
        }

        .drag-source {
            background: rgba(210, 180, 140, 0.1);
        }

        .drag-target {
            background: rgba(139, 69, 19, 0.05);
            transition: all 0.3s;
        }

        .drag-target.active {
            background: rgba(39, 174, 96, 0.1);
            border-color: #27ae60;
        }

        .drag-item {
            padding: 14px;
            margin: 10px 0;
            background: white;
            border: 2px solid #A0522D;
            border-radius: 8px;
            cursor: move;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.1rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        @media (max-width: 768px) {
            .drag-item {
                font-size: 1rem;
            }
        }

        .drag-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 12px rgba(0, 0, 0, 0.1);
            border-color: #8B4513;
        }

        .drag-item.dragging {
            opacity: 0.5;
            transform: scale(0.98);
        }

        .drag-item i {
            color: #8B4513;
            font-size: 1.1rem;
        }

        /* ТАЙМЛАЙН ЗАДАНИЕ */
        .timeline-container {
            margin: 25px 0;
        }

        .timeline {
            position: relative;
            padding: 20px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 30px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: #8B4513;
        }

        .timeline-event {
            display: flex;
            align-items: flex-start;
            margin-bottom: 30px;
            position: relative;
        }

        .timeline-date {
            width: 60px;
            text-align: center;
            font-weight: bold;
            color: #8B4513;
            font-size: 0.9rem;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .timeline-dot {
            width: 20px;
            height: 20px;
            background: #8B4513;
            border-radius: 50%;
            position: absolute;
            left: 25px;
            top: 0;
            border: 3px solid #FFFEF0;
            box-shadow: 0 0 0 3px #8B4513;
            z-index: 1;
        }

        .timeline-content {
            background: white;
            border: 2px solid #E8D0B3;
            border-radius: 8px;
            padding: 15px;
            margin-left: 40px;
            flex: 1;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.05);
            cursor: move;
        }

        .timeline-content.dragging {
            opacity: 0.5;
        }

        .timeline-placeholder {
            height: 60px;
            border: 2px dashed #D2B48C;
            border-radius: 8px;
            margin: 10px 0 10px 40px;
            background: rgba(139, 69, 19, 0.05);
        }

        /* ОПЦИИ ВОПРОСОВ */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin: 20px 0;
        }
        
        .option {
            padding: 15px 18px;
            background: #f8f9fa;
            border: 3px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.1rem;
        }
        
        @media (max-width: 768px) {
            .option {
                font-size: 1.05rem;
            }
        }
        
        .option:hover {
            background: #e9ecef;
            border-color: #adb5bd;
            transform: translateX(5px);
        }
        
        .option.selected {
            background: rgba(52, 152, 219, 0.15);
            border-color: #3498db;
            color: #2980b9;
        }
        
        .option.correct {
            background: rgba(39, 174, 96, 0.15);
            border-color: #27ae60;
            color: #27ae60;
        }
        
        .option.incorrect {
            background: rgba(231, 76, 60, 0.15);
            border-color: #e74c3c;
            color: #e74c3c;
        }
        
        .option-letter {
            width: 35px;
            height: 35px;
            background: #e9ecef;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.1rem;
            flex-shrink: 0;
            transition: all 0.3s;
        }
        
        .option.selected .option-letter {
            background: #3498db;
            color: white;
            transform: scale(1.1);
        }

        /* НАВИГАЦИЯ */
        .page-navigation {
            padding: 25px 40px;
            background: #f9f9f9;
            border-top: 3px solid #E8D0B3;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
            gap: 15px;
            min-height: 90px;
        }

        @media (max-width: 768px) {
            .page-navigation {
                flex-direction: column;
                gap: 15px;
                padding: 20px;
                min-height: auto;
            }
        }

        .nav-btn {
            padding: 12px 25px;
            background: #8B4513;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            min-width: 140px;
            justify-content: center;
            font-size: 1rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        @media (max-width: 768px) {
            .nav-btn {
                width: 100%;
                min-width: auto;
            }
        }

        .nav-btn:hover:not(:disabled) {
            background: #A0522D;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-btn.next {
            background: #2c3e50;
        }

        .nav-btn.next:hover:not(:disabled) {
            background: #34495e;
        }

        /* Прогресс бар */
        .page-progress {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
            min-width: 180px;
        }

        @media (max-width: 768px) {
            .page-progress {
                width: 100%;
                margin-top: 10px;
                min-width: auto;
            }
        }

        .progress-text {
            font-size: 0.9rem;
            color: #666;
            font-weight: 500;
        }

        .progress-dots {
            display: flex;
            gap: 8px;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .progress-dot.active {
            background: #8B4513;
            transform: scale(1.3);
            box-shadow: 0 0 10px rgba(139, 69, 19, 0.3);
        }

        /* Результаты заданий */
        .task-result {
            padding: 20px;
            border-radius: 10px;
            margin: 25px 0;
            text-align: center;
            font-weight: bold;
            display: none;
            animation: resultAppear 0.5s ease;
            font-size: 1.1rem;
        }
        
        .task-result.success {
            background: rgba(39, 174, 96, 0.15);
            color: #27ae60;
            border: 3px solid rgba(39, 174, 96, 0.4);
            display: block;
        }
        
        .task-result.error {
            background: rgba(231, 76, 60, 0.15);
            color: #e74c3c;
            border: 3px solid rgba(231, 76, 60, 0.4);
            display: block;
        }
        
        .task-result i {
            margin-right: 12px;
            font-size: 1.3rem;
        }

        /* Попап бонусов */
        .bonus-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 25px 60px rgba(0, 0, 0, 0.4);
            z-index: 1000;
            text-align: center;
            display: none;
            animation: popIn 0.5s ease-out;
            border: 6px solid #f1c40f;
            max-width: 400px;
            width: 90%;
        }

        @media (max-width: 768px) {
            .bonus-popup {
                padding: 30px 20px;
            }
        }

        .bonus-popup.active {
            display: block;
        }

        .bonus-icon {
            font-size: 4rem;
            color: #f1c40f;
            margin-bottom: 20px;
            animation: bounce 0.8s ease infinite;
        }

        .bonus-popup h3 {
            color: #8B4513;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .bonus-popup p {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* ЭКРАН ЗАВЕРШЕНИЯ */
        .completion-screen {
            display: none;
            background: #FFFEF0;
            height: 850px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            padding: 40px;
            text-align: center;
            animation: pageFlip 0.6s ease-out;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .completion-screen {
                height: 95vh;
                max-height: 850px;
                padding: 30px 25px;
            }
        }

        @media (max-height: 900px) {
            .completion-screen {
                height: 90vh;
            }
        }

        .completion-screen.active {
            display: block;
        }

        .trophy {
            font-size: 5rem;
            color: #f1c40f;
            margin: 30px 0;
            animation: rotate 3s linear infinite;
            filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.2));
        }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 35px 0;
        }

        @media (max-width: 768px) {
            .result-stats {
                grid-template-columns: 1fr;
            }
        }

        .stat-box {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 3px solid #E8D0B3;
            transition: transform 0.3s;
        }

        .stat-box:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2.2rem;
            color: #8B4513;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .certificate {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin: 30px auto;
            max-width: 550px;
            border: 8px solid #D2B48C;
            animation: certificateAppear 1s ease;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* Анимации */
        @keyframes popIn {
            0% { 
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            70% { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% { 
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        @keyframes rotate {
            from { transform: rotateY(0deg); }
            to { transform: rotateY(360deg); }
        }

        @keyframes certificateAppear {
            from { 
                opacity: 0;
                transform: scale(0.8) rotate(-5deg);
            }
            to { 
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        @keyframes resultAppear {
            0% { 
                opacity: 0;
                transform: translateY(20px);
            }
            100% { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Скроллбар */
        .page-content::-webkit-scrollbar,
        .completion-screen::-webkit-scrollbar,
        .contract-preview::-webkit-scrollbar {
            width: 8px;
        }

        .page-content::-webkit-scrollbar-track,
        .completion-screen::-webkit-scrollbar-track,
        .contract-preview::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .page-content::-webkit-scrollbar-thumb,
        .completion-screen::-webkit-scrollbar-thumb,
        .contract-preview::-webkit-scrollbar-thumb {
            background: #D2B48C;
            border-radius: 4px;
        }

        .page-content::-webkit-scrollbar-thumb:hover,
        .completion-screen::-webkit-scrollbar-thumb:hover,
        .contract-preview::-webkit-scrollbar-thumb:hover {
            background: #8B4513;
        }
    </style>
</head>
<body>
    <!-- Попап бонусов -->
    <div id="bonus-popup" class="bonus-popup">
        <div class="bonus-icon">
            <i class="fas fa-star"></i>
        </div>
        <h3>Бонусные очки!</h3>
        <p id="bonus-text"></p>
        <button class="nav-btn" onclick="closeBonusPopup()" style="margin-top: 20px; background: #8B4513;">
            <i class="fas fa-check"></i> Продолжить
        </button>
    </div>

    <div class="container">
        <!-- ОБЛОЖКА ЖУРНАЛА -->
        <div id="journal-cover" class="journal-cover active">
            <div class="seal">
                <i class="fas fa-scale-balanced"></i>
                <div class="seal-text">Трудовое право</div>
            </div>
            
            <h1><i class="fas fa-scale-balanced"></i> Дневник трудовых прав</h1>
            <div class="subtitle">Интерактивный квест по трудовому праву</div>
            <div class="author">Практическое применение знаний ТК РФ</div>
            
            <!-- ОБНОВЛЁННЫЕ БЛОКИ НА ОБЛОЖКЕ -->
            <div class="features">
                <div class="feature">
                    <i class="fas fa-book"></i>
                    <h3>Изучение ТК РФ</h3>
                    <p>Сопоставление статей с реальными ситуациями</p>
                </div>
                <div class="feature">
                    <i class="fas fa-file-contract"></i>
                    <h3>Составление договора</h3>
                    <p>Интерактивный конструктор трудового договора</p>
                </div>
                <div class="feature">
                    <i class="fas fa-puzzle-piece"></i>
                    <h3>Разные форматы</h3>
                    <p>Drag & Drop, таймлайн, выбор документов</p>
                </div>
            </div>
            
            <button class="start-button" onclick="startQuest()">
                <i class="fas fa-play-circle"></i> Начать квест
            </button>
        </div>

        <!-- СТРАНИЦА 1 -->
        <div id="page1" class="journal-page">
            <div class="page-header">
                <div class="page-number">Лист 1</div>
                <div class="entry-date">15 февраля</div>
                <h1 class="page-title">Чёрный понедельник</h1>
                <div class="page-subtitle">Неожиданное увольнение</div>
            </div>
            
            <div class="page-content">
                <div class="entry-text">
                    Сегодня утром меня вызвал руководитель и вручил приказ об увольнении по сокращению штата. 
                    Три года я проработал в компании "СтальПрогресс" инженером, и вот такой финал... 
                    Я всегда добросовестно выполнял свои обязанности, вовремя сдавал проекты, 
                    никогда не нарушал трудовую дисциплину. И вот теперь — увольнение без предупреждения.
                </div>
                
                <div class="situation-box">
                    <h3><i class="fas fa-exclamation-triangle"></i> Ситуация</h3>
                    <p>Мне сказали, что сегодня мой последний рабочий день. Никакого двухмесячного уведомления, 
                    как того требует закон. Я в полном шоке — неужели так можно? В отделе кадров мне объяснили, 
                    что "в связи с тяжёлым финансовым положением компании процедура сокращена". Но разве это законно?</p>
                </div>
                
                <div class="task-container">
                    <div class="task-title">
                        <i class="fas fa-question-circle"></i> Вопрос на знание закона
                    </div>
                    <p>Согласно Трудовому кодексу РФ, какой минимальный срок предупреждения об увольнении по сокращению штата должен соблюдать работодатель?</p>
                    
                    <div class="options-container">
                        <div class="option" onclick="selectOption(this, 'page1', 'A')">
                            <span class="option-letter">А</span>
                            <span>1 месяц - в особых случаях работодатель может сократить срок, но только с письменного согласия работника и выплаты компенсации</span>
                        </div>
                        <div class="option" onclick="selectOption(this, 'page1', 'B')">
                            <span class="option-letter">Б</span>
                            <span>2 месяца - стандартный срок для всех случаев сокращения штата, установленный статьёй 180 ТК РФ</span>
                        </div>
                        <div class="option" onclick="selectOption(this, 'page1', 'C')">
                            <span class="option-letter">В</span>
                            <span>3 месяца - для работников предпенсионного возраста и лиц с семейными обязанностями</span>
                        </div>
                    </div>
                </div>
                
                <div id="page1-result" class="task-result"></div>
            </div>
            
            <div class="page-navigation">
                <button class="nav-btn" onclick="showCover()">
                    <i class="fas fa-arrow-left"></i> К обложке
                </button>
                <button id="check-page1-btn" class="nav-btn next" onclick="checkAnswer('page1', 'B')">
                    <i class="fas fa-check"></i> Проверить ответ
                </button>
                <button id="next-page1-btn" class="nav-btn next" style="display: none;" onclick="nextPage('page2')">
                    Далее <i class="fas fa-arrow-right"></i>
                </button>
                <div class="page-progress">
                    <div class="progress-text">Страница 1 из 6</div>
                    <div class="progress-dots">
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- СТРАНИЦА 2 - НОВОЕ ЗАДАНИЕ НА СОПОСТАВЛЕНИЕ СТАТЕЙ ТК РФ -->
        <div id="page2" class="journal-page">
            <div class="page-header">
                <div class="page-number">Лист 2</div>
                <div class="entry-date">16 февраля</div>
                <h1 class="page-title">Изучение Трудового кодекса</h1>
                <div class="page-subtitle">Соответствие статей ТК РФ реальным ситуациям</div>
            </div>
            
            <div class="page-content">
                <div class="entry-text">
                    После вчерашнего события я решил серьёзно изучить Трудовой кодекс, чтобы понять, какие статьи защищают 
                    права работников в различных ситуациях. Юрист посоветовал мне разобраться в основных нормах, 
                    которые регулируют типичные трудовые споры. Оказалось, что в ТК РФ есть чёткие правила для каждой ситуации, 
                    и работодатели часто нарушают их, рассчитывая на незнание работников.
                </div>
                
                <div class="situation-box">
                    <h3><i class="fas fa-book-open"></i> Важная информация</h3>
                    <p>Трудовой кодекс РФ содержит более 400 статей, регулирующих все аспекты трудовых отношений. 
                    Знание ключевых статей помогает защитить свои права. Особенно важно понимать, какая статья 
                    применяется в конкретной ситуации, чтобы правильно ссылаться на неё в переговорах с работодателем 
                    или в судебных заявлениях.</p>
                </div>
                
                <div class="task-container">
                    <div class="task-title">
                        <i class="fas fa-balance-scale"></i> Сопоставьте ситуации с соответствующими статьями ТК РФ
                    </div>
                    <p>Для каждой ситуации из трудовой практики выберите статью Трудового кодекса РФ, которая её регулирует:</p>
                    
                    <div class="matching-container">
                        <div class="matching-pair">
                            <div class="matching-situation">
                                1. Работодатель требует работать в выходной день без дополнительной оплаты или отгула, 
                                аргументируя это "производственной необходимостью"
                            </div>
                            <select class="matching-select" id="situation1" onchange="checkMatchingAnswer('situation1')">
                                <option value="">Выберите статью</option>
                                <option value="113">Статья 113. Запрещение работы в выходные и нерабочие праздничные дни</option>
                                <option value="153">Статья 153. Оплата труда в выходные и нерабочие праздничные дни</option>
                                <option value="99">Статья 99. Сверхурочная работа</option>
                                <option value="128">Статья 128. Отпуск без сохранения заработной платы</option>
                            </select>
                        </div>
                        
                        <div class="matching-pair">
                            <div class="matching-situation">
                                2. Работнику не выплачивают заработную плату более 3 месяцев, при этом работодатель 
                                ссылается на временные финансовые трудности и просит "потерпеть"
                            </div>
                            <select class="matching-select" id="situation2" onchange="checkMatchingAnswer('situation2')">
                                <option value="">Выберите статью</option>
                                <option value="142">Статья 142. Ответственность работодателя за задержку выплаты заработной платы</option>
                                <option value="136">Статья 136. Порядок, место и сроки выплаты заработной платы</option>
                                <option value="236">Статья 236. Материальная ответственность работодателя за задержку заработной платы</option>
                                <option value="80">Статья 80. Расторжение трудового договора по инициативе работника</option>
                            </select>
                        </div>
                        
                        <div class="matching-pair">
                            <div class="matching-situation">
                                3. При приёме на работу не оформили трудовой договор, обещая сделать это "позже", 
                                а работник уже месяц работает без официального оформления
                            </div>
                            <select class="matching-select" id="situation3" onchange="checkMatchingAnswer('situation3')">
                                <option value="">Выберите статью</option>
                                <option value="67">Статья 67. Форма трудового договора</option>
                                <option value="61">Статья 61. Вступление трудового договора в силу</option>
                                <option value="16">Статья 16. Основания возникновения трудовых отношений</option>
                                <option value="57">Статья 57. Содержание трудового договора</option>
                            </select>
                        </div>
                        
                        <div class="matching-pair">
                            <div class="matching-situation">
                                4. Работника увольняют по инициативе работодателя без объяснения причин, 
                                просто вручая приказ об увольнении "по соглашению сторон"
                            </div>
                            <select class="matching-select" id="situation4" onchange="checkMatchingAnswer('situation4')">
                                <option value="">Выберите статью</option>
                                <option value="81">Статья 81. Расторжение трудового договора по инициативе работодателя</option>
                                <option value="82">Статья 82. Обязательное участие выборного органа первичной профсоюзной организации</option>
                                <option value="84">Статья 84. Прекращение трудового договора вследствие нарушения правил его заключения</option>
                                <option value="78">Статья 78. Расторжение трудового договора по соглашению сторон</option>
                            </select>
                        </div>
                        
                        <div class="matching-pair">
                            <div class="matching-situation">
                                5. Работник получил производственную травму на рабочем месте, 
                                а работодатель отказывается оформлять несчастный случай и отправляет лечиться "за свой счёт"
                            </div>
                            <select class="matching-select" id="situation5" onchange="checkMatchingAnswer('situation5')">
                                <option value="">Выберите статью</option>
                                <option value="227">Статья 227. Несчастные случаи, подлежащие расследованию</option>
                                <option value="228">Статья 228. Обязанности работодателя при несчастном случае</option>
                                <option value="184">Статья 184. Гарантии и компенсации при несчастном случае на производстве</option>
                                <option value="229">Статья 229. Порядок формирования комиссий по расследованию несчастных случаев</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(52, 152, 219, 0.1); border-radius: 8px; border-left: 4px solid #3498db;">
                        <h4><i class="fas fa-lightbulb"></i> Подсказка</h4>
                        <p>Правильные соответствия: <br>
                        1-153 (Статья 153 регулирует оплату работы в выходные дни в повышенном размере), <br>
                        2-142 (Статья 142 устанавливает ответственность работодателя за задержку зарплаты), <br>
                        3-67 (Статья 67 определяет обязательную письменную форму трудового договора), <br>
                        4-81 (Статья 81 перечисляет основания для увольнения по инициативе работодателя), <br>
                        5-184 (Статья 184 гарантирует компенсации при производственной травме).</p>
                    </div>
                </div>
                
                <div id="page2-result" class="task-result"></div>
            </div>
            
            <div class="page-navigation">
                <button class="nav-btn" onclick="prevPage('page1')">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
                <button id="check-page2-btn" class="nav-btn next" onclick="checkAllMatchingAnswers()">
                    <i class="fas fa-check"></i> Проверить все ответы
                </button>
                <button id="next-page2-btn" class="nav-btn next" style="display: none;" onclick="nextPage('page3')">
                    Далее <i class="fas fa-arrow-right"></i>
                </button>
                <div class="page-progress">
                    <div class="progress-text">Страница 2 из 6</div>
                    <div class="progress-dots">
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- СТРАНИЦА 3 - СОБИРАЕМ ДОКУМЕНТЫ -->
        <div id="page3" class="journal-page">
            <div class="page-header">
                <div class="page-number">Лист 3</div>
                <div class="entry-date">20 марта</div>
                <h1 class="page-title">Новый старт</h1>
                <div class="page-subtitle">Приём на работу в "ТехноИнновации"</div>
            </div>
            
            <div class="page-content">
                <div class="entry-text">
                    После неприятной истории с увольнением я нашел новую работу! Сегодня первый день в компании "ТехноИнновации". 
                    Настроение улучшилось, хотя осадок от прошлой работы ещё остался. Новый офис расположен в современном 
                    бизнес-центре, коллеги кажутся приятными людьми. Руководитель отдела провёл небольшую экскурсию и представил 
                    команде. Теперь предстоит знакомство с рабочими процессами и, конечно же, официальное оформление.
                </div>
                
                <div class="situation-box">
                    <h3><i class="fas fa-briefcase"></i> Ситуация</h3>
                    <p>Меня пригласили в отдел кадров для оформления документов. HR-менеджер Ольга попросила предоставить 
                    пакет документов, но перечислила довольно много позиций... Некоторые документы у меня с собой, 
                    другие нужно будет принести позже. Важно разобраться, какие документы обязательны по закону, 
                    а какие работодатель может запросить дополнительно.</p>
                </div>
                
                <div class="task-container">
                    <div class="task-title">
                        <i class="fas fa-file-export"></i> Сбор документов при приёме на работу
                    </div>
                    <p>Согласно статье 65 ТК РФ, при заключении трудового договора работник предъявляет работодателю 
                    определенные документы. Перетащите обязательные документы из левой колонки в правую:</p>
                    
                    <div class="drag-drop-container">
                        <div class="drag-drop-area">
                            <div class="drag-source" id="drag-source">
                                <div class="drag-item" draggable="true" data-id="passport">
                                    <i class="fas fa-id-card"></i> Паспорт гражданина РФ (или иной документ, удостоверяющий личность)
                                </div>
                                <div class="drag-item" draggable="true" data-id="diploma">
                                    <i class="fas fa-graduation-cap"></i> Диплом о высшем образовании (если работа требует специальных знаний)
                                </div>
                                <div class="drag-item" draggable="true" data-id="workbook">
                                    <i class="fas fa-book"></i> Трудовая книжка (кроме случаев поступления на работу впервые)
                                </div>
                                <div class="drag-item" draggable="true" data-id="snils">
                                    <i class="fas fa-address-card"></i> СНИЛС - страховое свидетельство государственного пенсионного страхования
                                </div>
                                <div class="drag-item" draggable="true" data-id="inn">
                                    <i class="fas fa-file-invoice-dollar"></i> ИНН - свидетельство о постановке на налоговый учёт
                                </div>
                                <div class="drag-item" draggable="true" data-id="military">
                                    <i class="fas fa-shield-alt"></i> Военный билет или удостоверение гражданина, подлежащего призыву
                                </div>
                                <div class="drag-item" draggable="true" data-id="medical">
                                    <i class="fas fa-heartbeat"></i> Медицинская книжка (для работников пищевой промышленности, медицины, образования)
                                </div>
                                <div class="drag-item" draggable="true" data-id="certificate">
                                    <i class="fas fa-award"></i> Справка о наличии (отсутствии) судимости (для педагогической деятельности)
                                </div>
                            </div>
                            <div class="drag-target" id="drag-target">
                                <p style="color: #666; font-style: italic; margin-top: 80px;">Перетащите сюда обязательные документы по статье 65 ТК РФ</p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(139, 69, 19, 0.1); border-radius: 8px; border-left: 4px solid #8B4513;">
                        <h4><i class="fas fa-info-circle"></i> Полезная информация</h4>
                        <p>Согласно статье 65 ТК РФ, обязательными документами являются: паспорт, трудовая книжка (кроме первого трудоустройства), 
                        СНИЛС, военный учёт (для военнообязанных). ИНН обычно запрашивается, но не является обязательным по ТК РФ. 
                        Остальные документы предоставляются в особых случаях, предусмотренных законом.</p>
                    </div>
                </div>
                
                <div id="page3-result" class="task-result"></div>
            </div>
            
            <div class="page-navigation">
                <button class="nav-btn" onclick="prevPage('page2')">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
                <button id="check-page3-btn" class="nav-btn next" onclick="checkDragDropAnswer()">
                    <i class="fas fa-check"></i> Проверить
                </button>
                <button id="next-page3-btn" class="nav-btn next" style="display: none;" onclick="nextPage('page4')">
                    Далее <i class="fas fa-arrow-right"></i>
                </button>
                <div class="page-progress">
                    <div class="progress-text">Страница 3 из 6</div>
                    <div class="progress-dots">
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- СТРАНИЦА 4 - ТАЙМЛАЙН УВОЛЬНЕНИЯ -->
        <div id="page4" class="journal-page">
            <div class="page-header">
                <div class="page-number">Лист 4</div>
                <div class="entry-date">20 декабря</div>
                <h1 class="page-title">Процедура увольнения</h1>
                <div class="page-subtitle">Восстановление хронологии законной процедуры</div>
            </div>
            
            <div class="page-content">
                <div class="entry-text">
                    Консультируясь с юристом, я понял, что мое увольнение было проведено с многочисленными нарушениями. 
                    Давайте восстановим правильную процедуру увольнения по сокращению штата согласно Трудовому кодексу РФ. 
                    Закон устанавливает чёткую последовательность действий, которую работодатель обязан соблюдать, 
                    и любое отступление от этой процедуры делает увольнение незаконным.
                </div>
                
                <div class="situation-box">
                    <h3><i class="fas fa-gavel"></i> Юридический комментарий</h3>
                    <p>Увольнение по сокращению штата — одна из самых сложных процедур в трудовом праве. 
                    Она требует от работодателя соблюдения множества формальностей: уведомления работника, 
                    предложения альтернативных вакансий, учёта мнения профсоюза (при его наличии), выплаты всех 
                    положенных компенсаций. Нарушение любого из этих этапов даёт работнику право на восстановление 
                    на работе через суд.</p>
                </div>
                
                <div class="task-container">
                    <div class="task-title">
                        <i class="fas fa-timeline"></i> Восстановите порядок процедуры увольнения по сокращению штата
                    </div>
                    <p>Расставьте этапы процедуры увольнения по сокращению штата в правильном порядке, перетаскивая их на таймлайн:</p>
                    
                    <div class="timeline-container">
                        <div class="timeline" id="timeline">
                            <div class="timeline-event" data-id="notice">
                                <div class="timeline-date">За 2 месяца</div>
                                <div class="timeline-dot"></div>
                                <div class="timeline-content" draggable="true">
                                    <strong>Уведомление работника</strong><br>
                                    Работодатель письменно уведомляет работника о предстоящем увольнении под роспись (статья 180 ТК РФ)
                                </div>
                            </div>
                            
                            <div class="timeline-event" data-id="vacancies">
                                <div class="timeline-date">В течение 2 месяцев</div>
                                <div class="timeline-dot"></div>
                                <div class="timeline-content" draggable="true">
                                    <strong>Предложение вакансий</strong><br>
                                    Работодатель предлагает имеющиеся вакансии, соответствующие квалификации работника (статья 81 ТК РФ)
                                </div>
                            </div>
                            
                            <div class="timeline-event" data-id="approval">
                                <div class="timeline-date">За 2 месяца</div>
                                <div class="timeline-dot"></div>
                                <div class="timeline-content" draggable="true">
                                    <strong>Согласование с профсоюзом</strong><br>
                                    При наличии профсоюза - получение его согласия на увольнение (статья 82 ТК РФ)
                                </div>
                            </div>
                            
                            <div class="timeline-event" data-id="payment">
                                <div class="timeline-date">Последний день</div>
                                <div class="timeline-dot"></div>
                                <div class="timeline-content" draggable="true">
                                    <strong>Выплаты</strong><br>
                                    Выплата выходного пособия, компенсации за неиспользованный отпуск и иных причитающихся сумм (статья 140 ТК РФ)
                                </div>
                            </div>
                            
                            <div class="timeline-event" data-id="order">
                                <div class="timeline-date">В день увольнения</div>
                                <div class="timeline-dot"></div>
                                <div class="timeline-content" draggable="true">
                                    <strong>Издание приказа</strong><br>
                                    Издание приказа об увольнении и ознакомление с ним работника под роспись (статья 84.1 ТК РФ)
                                </div>
                            </div>
                            
                            <div class="timeline-event" data-id="workbook">
                                <div class="timeline-date">В день увольнения</div>
                                <div class="timeline-dot"></div>
                                <div class="timeline-content" draggable="true">
                                    <strong>Выдача документов</strong><br>
                                    Выдача трудовой книжки и справки о заработной плате (статья 84.1 ТК РФ)
                                </div>
                            </div>
                        </div>
                        
                        <div class="timeline-placeholder" id="timeline-placeholder"></div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: rgba(155, 89, 182, 0.1); border-radius: 8px; border-left: 4px solid #9b59b6;">
                            <h4><i class="fas fa-list-ol"></i> Правильный порядок процедуры:</h4>
                            <p>1. Уведомление за 2 месяца → 2. Согласование с профсоюзом (при наличии) → 3. Предложение вакансий → 
                            4. Издание приказа в день увольнения → 5. Выдача документов → 6. Выплаты</p>
                        </div>
                    </div>
                </div>
                
                <div id="page4-result" class="task-result"></div>
            </div>
            
            <div class="page-navigation">
                <button class="nav-btn" onclick="prevPage('page3')">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
                <button id="check-page4-btn" class="nav-btn next" onclick="checkTimelineAnswer()">
                    <i class="fas fa-check"></i> Проверить порядок
                </button>
                <button id="next-page4-btn" class="nav-btn next" style="display: none;" onclick="nextPage('page5')">
                    Далее <i class="fas fa-arrow-right"></i>
                </button>
                <div class="page-progress">
                    <div class="progress-text">Страница 4 из 6</div>
                    <div class="progress-dots">
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- СТРАНИЦА 5 - НОВОЕ ИНТЕРАКТИВНОЕ ЗАДАНИЕ: КОНСТРУКТОР ТРУДОВОГО ДОГОВОРА -->
        <div id="page5" class="journal-page">
            <div class="page-header">
                <div class="page-number">Лист 5</div>
                <div class="entry-date">25 декабря</div>
                <h1 class="page-title">Конструктор трудового договора</h1>
                <div class="page-subtitle">Составление правильного договора согласно ТК РФ</div>
            </div>
            
            <div class="page-content">
                <div class="entry-text">
                    Юрист объяснил, насколько важно правильно составить трудовой договор. Многие работодатели 
                    используют шаблонные формулировки, которые нарушают права работников. Давайте соберём правильный 
                    вариант договора, соответствующий требованиям Трудового кодекса РФ. Каждый пункт договора должен 
                    чётко соответствовать нормам закона, иначе он может быть признан недействительным.
                </div>
                
                <div class="situation-box">
                    <h3><i class="fas fa-file-signature"></i> Важность правильного договора</h3>
                    <p>Трудовой договор — это основной документ, регулирующий отношения между работником и работодателем. 
                    Согласно статье 57 ТК РФ, он должен содержать обязательные условия: место работы, трудовая функция, 
                    дата начала работы, условия оплаты, режим рабочего времени и отдыха. Отсутствие этих условий 
                    или их несоответствие закону может привести к спорным ситуациям.</p>
                </div>
                
                <div class="task-container">
                    <div class="task-title">
                        <i class="fas fa-file-contract"></i> Составьте правильный трудовой договор
                    </div>
                    <p>Выберите правильные формулировки для каждого пункта трудового договора согласно требованиям ТК РФ:</p>
                    
                    <div class="contract-builder">
                        <div class="contract-clause" id="clause1">
                            <div class="clause-title">
                                <span>1. Предмет договора (трудовая функция)</span>
                                <span class="clause-status">Не выбрано</span>
                            </div>
                            <div class="clause-options">
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause1', 'A')">
                                    Работник обязуется выполнять любую работу по указанию работодателя, а работодатель обязуется выплачивать зарплату.
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause1', 'B')">
                                    Работник обязуется выполнять работу по должности инженера, а работодатель обязуется выплачивать зарплату и обеспечить условия труда.
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause1', 'C')">
                                    Работник обязуется выполнять трудовую функцию согласно штатному расписанию (должность "инженер"), а работодатель обязуется предоставить работу, обеспечить условия труда и своевременно выплачивать заработную плату.
                                </div>
                            </div>
                        </div>
                        
                        <div class="contract-clause" id="clause2">
                            <div class="clause-title">
                                <span>2. Срок действия договора</span>
                                <span class="clause-status">Не выбрано</span>
                            </div>
                            <div class="clause-options">
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause2', 'A')">
                                    На неопределённый срок (бессрочный договор)
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause2', 'B')">
                                    На 1 год с возможностью продления
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause2', 'C')">
                                    На время выполнения проекта (примерно 6-8 месяцев)
                                </div>
                            </div>
                        </div>
                        
                        <div class="contract-clause" id="clause3">
                            <div class="clause-title">
                                <span>3. Режим рабочего времени и отдыха</span>
                                <span class="clause-status">Не выбрано</span>
                            </div>
                            <div class="clause-options">
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause3', 'A')">
                                    Рабочий день с 9:00 до 18:00 с перерывом на обед с 13:00 до 14:00, пятидневная рабочая неделя с двумя выходными днями (суббота и воскресенье)
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause3', 'B')">
                                    Рабочий день устанавливается работодателем по мере необходимости
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause3', 'C')">
                                    Ненормированный рабочий день по согласованию с работником
                                </div>
                            </div>
                        </div>
                        
                        <div class="contract-clause" id="clause4">
                            <div class="clause-title">
                                <span>4. Оплата труда</span>
                                <span class="clause-status">Не выбрано</span>
                            </div>
                            <div class="clause-options">
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause4', 'A')">
                                    Оклад 85 000 рублей в месяц, выплата 5 и 20 числа каждого месяца
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause4', 'B')">
                                    Зарплата выплачивается по итогам месяца, размер определяется работодателем
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause4', 'C')">
                                    Оклад 85 000 рублей в месяц, выплата дважды в месяц: аванс 40% 20 числа и окончательный расчёт 5 числа следующего месяца
                                </div>
                            </div>
                        </div>
                        
                        <div class="contract-clause" id="clause5">
                            <div class="clause-title">
                                <span>5. Отпуск</span>
                                <span class="clause-status">Не выбрано</span>
                            </div>
                            <div class="clause-options">
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause5', 'A')">
                                    28 календарных дней ежегодного оплачиваемого отпуска, предоставляется согласно графику отпусков
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause5', 'B')">
                                    Отпуск предоставляется по согласованию с работодателем
                                </div>
                                <div class="clause-option" onclick="selectClauseOption(this, 'clause5', 'C')">
                                    14 дней отпуска ежегодно, остальные дни могут быть заменены денежной компенсацией
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="contract-preview" id="contract-preview">
                        <div class="contract-line"><strong>ТРУДОВОЙ ДОГОВОР № ___</strong></div>
                        <div class="contract-line">г. Москва _________________________</div>
                        <div class="contract-line"><br></div>
                        <div class="contract-line" id="preview-clause1">[1. Предмет договора (трудовая функция)]</div>
                        <div class="contract-line" id="preview-clause2">[2. Срок действия договора]</div>
                        <div class="contract-line" id="preview-clause3">[3. Режим рабочего времени и отдыха]</div>
                        <div class="contract-line" id="preview-clause4">[4. Оплата труда]</div>
                        <div class="contract-line" id="preview-clause5">[5. Отпуск]</div>
                        <div class="contract-line"><br></div>
                        <div class="contract-line"><strong>РАБОТОДАТЕЛЬ:</strong> ООО "ТехноИнновации" _________________________</div>
                        <div class="contract-line"><strong>РАБОТНИК:</strong> Иван Сергеевич Петров _________________________</div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: rgba(241, 196, 15, 0.1); border-radius: 8px; border-left: 4px solid #f1c40f;">
                        <h4><i class="fas fa-gavel"></i> Правовой комментарий</h4>
                        <p>Согласно статье 57 ТК РФ, трудовой договор должен содержать все существенные условия. 
                        Трудовая функция должна быть конкретной, срок договора — определённым, режим работы — 
                        чётко установленным, оплата — указана с размерами и сроками выплаты, отпуск — 
                        не менее 28 календарных дней. Любые формулировки типа "по усмотрению работодателя" или 
                        "по мере необходимости" нарушают права работника.</p>
                    </div>
                </div>
                
                <div id="page5-result" class="task-result"></div>
            </div>
            
            <div class="page-navigation">
                <button class="nav-btn" onclick="prevPage('page4')">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
                <button id="check-page5-btn" class="nav-btn next" onclick="checkContractBuilder()">
                    <i class="fas fa-check"></i> Проверить договор
                </button>
                <button id="next-page5-btn" class="nav-btn next" style="display: none;" onclick="nextPage('page6')">
                    Далее <i class="fas fa-arrow-right"></i>
                </button>
                <div class="page-progress">
                    <div class="progress-text">Страница 5 из 6</div>
                    <div class="progress-dots">
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- СТРАНИЦА 6 - ОБРАЩЕНИЕ В СУД -->
        <div id="page6" class="journal-page">
            <div class="page-header">
                <div class="page-number">Лист 6</div>
                <div class="entry-date">15 марта</div>
                <h1 class="page-title">Путь к справедливости</h1>
                <div class="page-subtitle">Обращение в суд за защитой трудовых прав</div>
            </div>
            
            <div class="page-content">
                <div class="entry-text">
                    После консультации с юристом я понял, что мое увольнение было незаконным. Работодатель нарушил 
                    процедуру сокращения по нескольким пунктам: не было двухмесячного уведомления, не предложили 
                    имеющиеся вакансии, не выплатили положенные компенсации в полном объёме. Я решил бороться за свои 
                    права и восстановиться на работе через суд. Это непростой путь, но он того стоит.
                </div>
                
                <div class="situation-box">
                    <h3><i class="fas fa-balance-scale"></i> Ситуация</h3>
                    <p>Юрист сказал, что важно не пропустить срок обращения в суд. Согласно статье 392 ТК РФ, 
                    работник имеет один месяц со дня вручения ему копии приказа об увольнении для обращения в суд. 
                    Также нужно правильно подготовить пакет документов и составить исковое заявление. 
                    Я решил подать иск в суд для восстановления на работе и взыскания компенсации за вынужденный прогул.</p>
                </div>
                
                <div class="task-container">
                    <div class="task-title">
                        <i class="fas fa-question-circle"></i> Вопрос на знание процессуальных сроков
                    </div>
                    <p>В течение какого срока работник может обратиться в суд по спору об увольнении согласно Трудовому кодексу РФ?</p>
                    
                    <div class="options-container">
                        <div class="option" onclick="selectOption(this, 'page6', 'A')">
                            <span class="option-letter">А</span>
                            <span>1 месяц со дня вручения копии приказа об увольнении либо со дня выдачи трудовой книжки (статья 392 ТК РФ)</span>
                        </div>
                        <div class="option" onclick="selectOption(this, 'page6', 'B')">
                            <span class="option-letter">Б</span>
                            <span>3 месяца со дня, когда работник узнал о нарушении своего права (общий срок по трудовым спорам)</span>
                        </div>
                        <div class="option" onclick="selectOption(this, 'page6', 'C')">
                            <span class="option-letter">В</span>
                            <span>1 год со дня увольнения (срок исковой давности)</span>
                        </div>
                        <div class="option" onclick="selectOption(this, 'page6', 'D')">
                            <span class="option-letter">Г</span>
                            <span>2 недели с момента увольнения</span>
                        </div>
                    </div>
                </div>
                
                <div class="task-container" style="margin-top: 30px;">
                    <div class="task-title">
                        <i class="fas fa-file-contract"></i> Составление пакета документов для подачи иска в суд
                    </div>
                    <p>Для обращения в суд с иском о восстановлении на работе необходимо подготовить пакет документов. 
                    Отметьте необходимые документы для подачи иска в суд:</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin: 20px 0;">
                        <div class="option" onclick="toggleDocument(this, 'page6', 'claim')">
                            <span class="option-letter"><i class="far fa-square"></i></span>
                            <span>Исковое заявление с требованием о восстановлении на работе</span>
                        </div>
                        <div class="option" onclick="toggleDocument(this, 'page6', 'passport')">
                            <span class="option-letter"><i class="far fa-square"></i></span>
                            <span>Копия паспорта (страницы с фото и пропиской)</span>
                        </div>
                        <div class="option" onclick="toggleDocument(this, 'page6', 'order')">
                            <span class="option-letter"><i class="far fa-square"></i></span>
                            <span>Копия приказа об увольнении (основание для иска)</span>
                        </div>
                        <div class="option" onclick="toggleDocument(this, 'page6', 'workbook')">
                            <span class="option-letter"><i class="far fa-square"></i></span>
                            <span>Копия трудовой книжки (подтверждение трудовых отношений)</span>
                        </div>
                        <div class="option" onclick="toggleDocument(this, 'page6', 'contract')">
                            <span class="option-letter"><i class="far fa-square"></i></span>
                            <span>Копия трудового договора (условия работы)</span>
                        </div>
                        <div class="option" onclick="toggleDocument(this, 'page6', 'salary')">
                            <span class="option-letter"><i class="far fa-square"></i></span>
                            <span>Справка о заработной плате (для расчёта компенсации)</span>
                        </div>
                        <div class="option" onclick="toggleDocument(this, 'page6', 'notification')">
                            <span class="option-letter"><i class="far fa-square"></i></span>
                            <span>Копия уведомления о сокращении (если выдавалось)</span>
                        </div>
                        <div class="option" onclick="toggleDocument(this, 'page6', 'receipt')">
                            <span class="option-letter"><i class="far fa-square"></i></span>
                            <span>Квитанция об оплате государственной пошлины</span>
                        </div>
                    </div>
                    
                    <button id="check-documents-btn" class="nav-btn" style="margin-top: 15px; background: #27ae60;" onclick="checkDocumentsAnswer('page6')">
                        <i class="fas fa-check"></i> Проверить документы
                    </button>
                </div>
                
                <div id="page6-result" class="task-result"></div>
                <div id="page6-docs-result" class="task-result" style="display: none;"></div>
            </div>
            
            <div class="page-navigation">
                <button class="nav-btn" onclick="prevPage('page5')">
                    <i class="fas fa-arrow-left"></i> Назад
                </button>
                <button id="check-page6-btn" class="nav-btn next" onclick="checkAnswer('page6', 'A')">
                    <i class="fas fa-check"></i> Проверить срок
                </button>
                <button id="next-page6-btn" class="nav-btn next" style="display: none;" onclick="completeQuest()">
                    Завершить квест <i class="fas fa-flag-checkered"></i>
                </button>
                <div class="page-progress">
                    <div class="progress-text">Страница 6 из 6</div>
                    <div class="progress-dots">
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot active"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ЭКРАН ЗАВЕРШЕНИЯ -->
        <div id="completion-screen" class="completion-screen">
            <h1><i class="fas fa-trophy"></i> Квест завершён!</h1>
            <div class="trophy">
                <i class="fas fa-award"></i>
            </div>
            <p style="font-size: 1.2rem; margin-bottom: 30px; color: #666;">
                Поздравляем! Вы успешно помогли Ивану разобраться в трудовом праве и защитить свои права.
            </p>
            
            <div class="result-stats">
                <div class="stat-box">
                    <div class="stat-value" id="final-score">0</div>
                    <div class="stat-label">Набрано очков</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="final-time">00:00</div>
                    <div class="stat-label">Затраченное время</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="final-accuracy">100%</div>
                    <div class="stat-label">Точность ответов</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="final-bonuses">0</div>
                    <div class="stat-label">Бонусные очки</div>
                </div>
            </div>
            
            <div class="certificate">
                <h2 style="font-size: 1.4rem;"><i class="fas fa-scroll"></i> Сертификат об успешном прохождении</h2>
                <p style="margin: 20px 0; font-size: 1.1rem;">
                    Этот сертификат подтверждает успешное прохождение 
                    интерактивного квеста <strong>"Дневник трудовых прав"</strong>.
                </p>
                <p style="margin-bottom: 20px; color: #666; font-size: 1rem;">
                    Продемонстрировано знание основ трудового права и умение применять 
                    их на практике в реальных ситуациях. Вы освоили:
                </p>
                <ul style="text-align: left; margin: 20px auto; max-width: 500px; color: #666;">
                    <li>Сопоставление статей ТК РФ с реальными ситуациями</li>
                    <li>Процедуру увольнения по сокращению штата</li>
                    <li>Правила приёма на работу и оформления документов</li>
                    <li>Составление трудового договора согласно ТК РФ</li>
                    <li>Порядок обращения в суд по трудовым спорам</li>
                </ul>
                <p style="font-weight: bold; color: #8B4513; margin-top: 25px; font-size: 1.1rem;">
                    <i class="fas fa-calendar-alt"></i> Дата: <span id="certificate-date"></span>
                </p>
            </div>
            
            <div style="margin-top: 30px; display: flex; gap: 20px; justify-content: center;">
                <button class="nav-btn" onclick="restartQuest()" style="background: #27ae60;">
                    <i class="fas fa-redo"></i> Пройти снова
                </button>
                <button class="nav-btn" onclick="showCover()" style="background: #8B4513;">
                    <i class="fas fa-book"></i> К обложке
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- Глобальные переменные ---
        let currentPage = 'journal-cover';
        let score = 0;
        let answeredPages = new Set();
        let selectedOptions = {};
        let selectedDocuments = {};
        let startTime = null;
        let timerInterval = null;
        let timeBonus = 0;
        let accuracyBonus = 0;
        let totalTimeSeconds = 0;
        let correctAnswers = 0;
        let totalQuestions = 0;
        let dragDropItems = [];
        let timelineOrder = [];
        let matchingAnswers = {
            'situation1': '',
            'situation2': '',
            'situation3': '',
            'situation4': '',
            'situation5': ''
        };
        let clauseSelections = {
            'clause1': '',
            'clause2': '',
            'clause3': '',
            'clause4': '',
            'clause5': ''
        };
        const correctClauses = {
            'clause1': 'C',
            'clause2': 'A',
            'clause3': 'A',
            'clause4': 'C',
            'clause5': 'A'
        };
        const clauseTexts = {
            'clause1': {
                'A': 'Работник обязуется выполнять любую работу по указанию работодателя, а работодатель обязуется выплачивать зарплату.',
                'B': 'Работник обязуется выполнять работу по должности инженера, а работодатель обязуется выплачивать зарплату и обеспечить условия труда.',
                'C': 'Работник обязуется выполнять трудовую функцию согласно штатному расписанию (должность "инженер"), а работодатель обязуется предоставить работу, обеспечить условия труда и своевременно выплачивать заработную плату.'
            },
            'clause2': {
                'A': 'На неопределённый срок (бессрочный договор)',
                'B': 'На 1 год с возможностью продления',
                'C': 'На время выполнения проекта (примерно 6-8 месяцев)'
            },
            'clause3': {
                'A': 'Рабочий день с 9:00 до 18:00 с перерывом на обед с 13:00 до 14:00, пятидневная рабочая неделя с двумя выходными днями (суббота и воскресенье)',
                'B': 'Рабочий день устанавливается работодателем по мере необходимости',
                'C': 'Ненормированный рабочий день по согласованию с работником'
            },
            'clause4': {
                'A': 'Оклад 85 000 рублей в месяц, выплата 5 и 20 числа каждого месяца',
                'B': 'Зарплата выплачивается по итогам месяца, размер определяется работодателем',
                'C': 'Оклад 85 000 рублей в месяц, выплата дважды в месяц: аванс 40% 20 числа и окончательный расчёт 5 числа следующего месяца'
            },
            'clause5': {
                'A': '28 календарных дней ежегодного оплачиваемого отпуска, предоставляется согласно графику отпусков',
                'B': 'Отпуск предоставляется по согласованию с работодателем',
                'C': '14 дней отпуска ежегодно, остальные дни могут быть заменены денежной компенсацией'
            }
        };

        // --- Инициализация ---
        document.addEventListener('DOMContentLoaded', function() {
            setupDragAndDrop();
            setupTimelineDragAndDrop();
            updateProgressDots();
        });

        // --- Навигация ---
        function startQuest() {
            document.getElementById('journal-cover').classList.add('hidden');
            document.getElementById('page1').classList.add('active');
            currentPage = 'page1';
            startTimer();
            updateProgressDots();
        }

        function showCover() {
            document.querySelectorAll('.journal-page, .completion-screen').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById('journal-cover').classList.remove('hidden');
            document.getElementById('journal-cover').classList.add('active');
            currentPage = 'journal-cover';
            stopTimer();
            updateProgressDots();
        }

        function nextPage(pageId) {
            if (answeredPages.has(currentPage)) {
                document.getElementById(currentPage).classList.remove('active');
                document.getElementById(pageId).classList.add('active');
                currentPage = pageId;
                updateProgressDots();
            } else {
                alert('Пожалуйста, сначала выполните задание на текущей странице.');
            }
        }

        function prevPage(pageId) {
            document.getElementById(currentPage).classList.remove('active');
            document.getElementById(pageId).classList.add('active');
            currentPage = pageId;
            updateProgressDots();
        }

        function restartQuest() {
            score = 0;
            answeredPages.clear();
            selectedOptions = {};
            selectedDocuments = {};
            dragDropItems = [];
            timelineOrder = [];
            matchingAnswers = {
                'situation1': '',
                'situation2': '',
                'situation3': '',
                'situation4': '',
                'situation5': ''
            };
            clauseSelections = {
                'clause1': '',
                'clause2': '',
                'clause3': '',
                'clause4': '',
                'clause5': ''
            };
            correctAnswers = 0;
            totalQuestions = 0;
            timeBonus = 0;
            accuracyBonus = 0;
            totalTimeSeconds = 0;
            
            // Сброс всех результатов
            document.querySelectorAll('.task-result').forEach(res => {
                res.innerHTML = '';
                res.className = 'task-result';
            });
            
            // Сброс опций
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                const icon = opt.querySelector('.option-letter i');
                if (icon) {
                    icon.className = 'far fa-square';
                }
            });
            
            // Сброс сопоставления статей
            document.querySelectorAll('.matching-select').forEach(select => {
                select.value = '';
                select.classList.remove('correct', 'incorrect');
            });
            
            // Сброс конструктора договора
            document.querySelectorAll('.contract-clause').forEach(clause => {
                clause.classList.remove('active', 'incorrect');
                const status = clause.querySelector('.clause-status');
                if (status) {
                    status.textContent = 'Не выбрано';
                    status.className = 'clause-status';
                }
                clause.querySelectorAll('.clause-option').forEach(opt => {
                    opt.classList.remove('selected', 'correct', 'incorrect');
                });
            });
            
            // Сброс preview договора
            document.querySelectorAll('.contract-line').forEach(line => {
                line.classList.remove('highlight');
                if (line.id.startsWith('preview-')) {
                    const clauseNum = line.id.replace('preview-clause', '');
                    line.textContent = `[${clauseNum}. ${getClauseTitle(clauseNum)}]`;
                }
            });
            
            // Сброс drag & drop
            const dragSource = document.getElementById('drag-source');
            const dragTarget = document.getElementById('drag-target');
            if (dragSource && dragTarget) {
                dragTarget.innerHTML = '<p style="color: #666; font-style: italic; margin-top: 80px;">Перетащите сюда обязательные документы по статье 65 ТК РФ</p>';
                dragTarget.classList.remove('active');
                document.querySelectorAll('.drag-item').forEach(item => {
                    dragSource.appendChild(item);
                    item.style.cursor = 'move';
                });
            }
            
            // Сброс таймлайна
            const timeline = document.getElementById('timeline');
            if (timeline) {
                const events = timeline.querySelectorAll('.timeline-event');
                events.forEach(event => {
                    event.style.order = '';
                });
            }
            
            // Сброс чекбоксов документов
            document.querySelectorAll('.option .fa-square').forEach(icon => {
                icon.className = 'far fa-square';
            });
            
            // Показать обложку
            document.getElementById('completion-screen').classList.remove('active');
            document.getElementById('journal-cover').classList.remove('hidden');
            document.getElementById('journal-cover').classList.add('active');
            currentPage = 'journal-cover';
            
            // Сброс кнопок
            document.querySelectorAll('.nav-btn.next').forEach(btn => {
                if (btn.id.startsWith('next-')) {
                    btn.style.display = 'none';
                } else if (btn.id.startsWith('check-')) {
                    btn.style.display = 'flex';
                }
            });
            
            // Скрыть кнопку проверки документов
            const checkDocsBtn = document.getElementById('check-documents-btn');
            if (checkDocsBtn) {
                checkDocsBtn.style.display = 'flex';
            }
            
            // Скрыть результат документов
            const docsResult = document.getElementById('page6-docs-result');
            if (docsResult) {
                docsResult.style.display = 'none';
            }
            
            stopTimer();
            updateProgressDots();
        }

        // --- Таймер ---
        function startTimer() {
            startTime = new Date();
            timerInterval = setInterval(function() {
                const now = new Date();
                totalTimeSeconds = Math.floor((now - startTime) / 1000);
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        // --- Система бонусов ---
        function calculateTimeBonus() {
            const timeLimit = 1200; // 20 минут для 6 страниц (увеличено из-за большего объёма)
            if (totalTimeSeconds < timeLimit) {
                timeBonus = Math.floor((timeLimit - totalTimeSeconds) / 60) * 50;
                return Math.max(timeBonus, 0);
            }
            return 0;
        }

        function calculateAccuracyBonus() {
            accuracyBonus = correctAnswers * 30;
            return accuracyBonus;
        }

        function showBonusPopup(message) {
            document.getElementById('bonus-text').textContent = message;
            document.getElementById('bonus-popup').classList.add('active');
            
            setTimeout(() => {
                closeBonusPopup();
            }, 3000);
        }

        function closeBonusPopup() {
            document.getElementById('bonus-popup').classList.remove('active');
        }

        // --- Drag & Drop для документов ---
        function setupDragAndDrop() {
            const dragItems = document.querySelectorAll('.drag-item');
            const dragTarget = document.getElementById('drag-target');
            
            if (!dragItems.length || !dragTarget) return;
            
            dragItems.forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    this.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', this.dataset.id);
                });
                
                item.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                });
            });
            
            dragTarget.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('active');
            });
            
            dragTarget.addEventListener('dragleave', function() {
                this.classList.remove('active');
            });
            
            dragTarget.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('active');
                
                const id = e.dataTransfer.getData('text/plain');
                const draggedItem = document.querySelector(`[data-id="${id}"]`);
                
                if (draggedItem && !this.contains(draggedItem)) {
                    this.appendChild(draggedItem);
                    draggedItem.style.cursor = 'default';
                    
                    const placeholder = this.querySelector('p');
                    if (placeholder) {
                        placeholder.style.display = 'none';
                    }
                    
                    if (!dragDropItems.includes(id)) {
                        dragDropItems.push(id);
                    }
                }
            });
        }

        // --- Drag & Drop для таймлайна ---
        function setupTimelineDragAndDrop() {
            const timeline = document.getElementById('timeline');
            if (!timeline) return;
            
            const timelineEvents = timeline.querySelectorAll('.timeline-content');
            const placeholder = document.getElementById('timeline-placeholder');
            
            let draggedEvent = null;
            
            timelineEvents.forEach(event => {
                event.addEventListener('dragstart', function(e) {
                    draggedEvent = this.parentElement;
                    this.classList.add('dragging');
                    e.dataTransfer.setData('text/plain', this.parentElement.dataset.id);
                });
                
                event.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    draggedEvent = null;
                    placeholder.style.display = 'none';
                });
            });
            
            timelineEvents.forEach(event => {
                event.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    const rect = this.getBoundingClientRect();
                    const midpoint = rect.top + rect.height / 2;
                    
                    if (e.clientY < midpoint) {
                        placeholder.style.display = 'block';
                        this.parentElement.before(placeholder);
                    } else {
                        placeholder.style.display = 'block';
                        this.parentElement.after(placeholder);
                    }
                });
            });
            
            placeholder.addEventListener('dragover', function(e) {
                e.preventDefault();
            });
            
            placeholder.addEventListener('drop', function(e) {
                e.preventDefault();
                if (draggedEvent) {
                    this.before(draggedEvent);
                    updateTimelineOrder();
                }
                this.style.display = 'none';
            });
            
            // Инициализация порядка
            updateTimelineOrder();
        }

        function updateTimelineOrder() {
            const timeline = document.getElementById('timeline');
            if (!timeline) return;
            
            const events = timeline.querySelectorAll('.timeline-event');
            timelineOrder = Array.from(events).map(event => event.dataset.id);
        }

        // --- Проверка заданий ---
        function checkDragDropAnswer() {
            const correctItems = ['passport', 'workbook', 'snils', 'military'];
            const resultDiv = document.getElementById('page3-result');
            const dragTarget = document.getElementById('drag-target');
            
            if (!resultDiv || !dragTarget) return;
            
            const isCorrect = correctItems.every(item => 
                document.querySelector(`#drag-target [data-id="${item}"]`)
            );
            
            const allItemsInTarget = Array.from(document.querySelectorAll('#drag-target .drag-item')).map(item => item.dataset.id);
            const hasExtraItems = allItemsInTarget.some(item => !correctItems.includes(item));
            
            if (isCorrect && !hasExtraItems) {
                resultDiv.innerHTML = '<i class="fas fa-check-circle"></i> Отлично! Вы правильно собрали все обязательные документы согласно статье 65 ТК РФ.';
                resultDiv.className = 'task-result success';
                
                if (!answeredPages.has('page3')) {
                    answeredPages.add('page3');
                    score += 120;
                    correctAnswers++;
                    totalQuestions++;
                    
                    if (totalTimeSeconds < 300) { // Меньше 5 минут
                        const bonus = 50;
                        score += bonus;
                        showBonusPopup(`Бонус +${bonus} очков за быстрый сбор документов!`);
                    }
                    
                    document.getElementById('check-page3-btn').style.display = 'none';
                    document.getElementById('next-page3-btn').style.display = 'flex';
                    updateProgressDots();
                }
            } else {
                resultDiv.innerHTML = '<i class="fas fa-exclamation-circle"></i> Не совсем. Проверьте, все ли обязательные документы вы перенесли и нет ли лишних. Обязательные: паспорт, трудовая книжка, СНИЛС, военный билет (для военнообязанных).';
                resultDiv.className = 'task-result error';
            }
        }

        function checkTimelineAnswer() {
            const correctOrder = ['notice', 'approval', 'vacancies', 'order', 'workbook', 'payment'];
            const resultDiv = document.getElementById('page4-result');
            
            if (!resultDiv) return;
            
            const isCorrect = JSON.stringify(timelineOrder) === JSON.stringify(correctOrder);
            
            if (isCorrect) {
                resultDiv.innerHTML = '<i class="fas fa-check-circle"></i> Верно! Вы правильно восстановили процедуру увольнения согласно ТК РФ.';
                resultDiv.className = 'task-result success';
                
                if (!answeredPages.has('page4')) {
                    answeredPages.add('page4');
                    score += 150; // Более сложное задание
                    correctAnswers++;
                    totalQuestions++;
                    
                    document.getElementById('check-page4-btn').style.display = 'none';
                    document.getElementById('next-page4-btn').style.display = 'flex';
                    updateProgressDots();
                }
            } else {
                resultDiv.innerHTML = '<i class="fas fa-times-circle"></i> Неверно. Попробуйте ещё раз. Правильный порядок: Уведомление → Согласование с профсоюзом → Предложение вакансий → Издание приказа → Выдача документов → Выплаты.';
                resultDiv.className = 'task-result error';
            }
        }

        // --- НОВЫЕ ФУНКЦИИ ДЛЯ ЗАДАНИЯ 2 (СОПОСТАВЛЕНИЕ СТАТЕЙ ТК РФ) ---
        function checkMatchingAnswer(situationId) {
            const select = document.getElementById(situationId);
            const value = select.value;
            matchingAnswers[situationId] = value;
            
            // Автоматическая проверка при выборе
            const correctAnswersMap = {
                'situation1': '153',
                'situation2': '142',
                'situation3': '67',
                'situation4': '81',
                'situation5': '184'
            };
            
            if (value === correctAnswersMap[situationId]) {
                select.classList.add('correct');
                select.classList.remove('incorrect');
            } else {
                select.classList.add('incorrect');
                select.classList.remove('correct');
            }
        }

        function checkAllMatchingAnswers() {
            totalQuestions += 5; // 5 ситуаций для сопоставления
            
            const correctAnswersMap = {
                'situation1': '153',
                'situation2': '142',
                'situation3': '67',
                'situation4': '81',
                'situation5': '184'
            };
            
            let correctCount = 0;
            let allAnswered = true;
            
            // Проверяем каждую ситуацию
            for (const [situationId, correctAnswer] of Object.entries(correctAnswersMap)) {
                const select = document.getElementById(situationId);
                const userAnswer = select.value;
                
                if (!userAnswer) {
                    allAnswered = false;
                    continue;
                }
                
                if (userAnswer === correctAnswer) {
                    select.classList.add('correct');
                    select.classList.remove('incorrect');
                    correctCount++;
                    correctAnswers++;
                } else {
                    select.classList.add('incorrect');
                    select.classList.remove('correct');
                }
            }
            
            const resultDiv = document.getElementById('page2-result');
            
            if (!allAnswered) {
                resultDiv.innerHTML = '<i class="fas fa-exclamation-circle"></i> Пожалуйста, выберите статьи для всех ситуаций.';
                resultDiv.className = 'task-result error';
                return;
            }
            
            if (correctCount === 5) {
                resultDiv.innerHTML = '<i class="fas fa-check-circle"></i> Отлично! Вы правильно сопоставили все ситуации со статьями ТК РФ.';
                resultDiv.className = 'task-result success';
                
                if (!answeredPages.has('page2')) {
                    answeredPages.add('page2');
                    score += 150; // Сложное задание - больше очков
                    
                    // Бонус за все правильные ответы
                    if (correctCount === 5) {
                        const bonus = 75;
                        score += bonus;
                        showBonusPopup(`Бонус +${bonus} очков за все правильные сопоставления!`);
                    }
                    
                    document.getElementById('check-page2-btn').style.display = 'none';
                    document.getElementById('next-page2-btn').style.display = 'flex';
                    updateProgressDots();
                }
            } else {
                resultDiv.innerHTML = `<i class="fas fa-times-circle"></i> Правильно сопоставлено ${correctCount} из 5 ситуаций. Попробуйте ещё раз.`;
                resultDiv.className = 'task-result error';
            }
        }

        // --- НОВЫЕ ФУНКЦИИ ДЛЯ ЗАДАНИЯ 5 (КОНСТРУКТОР ДОГОВОРА) ---
        function getClauseTitle(clauseNum) {
            const titles = {
                '1': 'Предмет договора (трудовая функция)',
                '2': 'Срок действия договора',
                '3': 'Режим рабочего времени и отдыха',
                '4': 'Оплата труда',
                '5': 'Отпуск'
            };
            return titles[clauseNum] || 'Пункт договора';
        }

        function selectClauseOption(element, clauseId, optionValue) {
            const clause = document.getElementById(clauseId);
            const clauseNum = clauseId.replace('clause', '');
            const previewElement = document.getElementById(`preview-clause${clauseNum}`);
            const statusElement = clause.querySelector('.clause-status');
            
            // Сброс предыдущего выбора в этом пункте
            clause.querySelectorAll('.clause-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Устанавливаем новый выбор
            element.classList.add('selected');
            clauseSelections[clauseId] = optionValue;
            
            // Обновляем статус
            statusElement.textContent = 'Выбрано';
            statusElement.className = 'clause-status';
            
            // Обновляем preview договора
            previewElement.textContent = `${clauseNum}. ${clauseTexts[clauseId][optionValue]}`;
            previewElement.classList.add('highlight');
            
            // Активируем пункт договора
            clause.classList.add('active');
        }

        function checkContractBuilder() {
            totalQuestions += 5; // 5 пунктов договора
            
            let allSelected = true;
            let correctCount = 0;
            
            // Проверяем каждый пункт
            for (const [clauseId, userSelection] of Object.entries(clauseSelections)) {
                if (!userSelection) {
                    allSelected = false;
                    continue;
                }
                
                const clause = document.getElementById(clauseId);
                const statusElement = clause.querySelector('.clause-status');
                const clauseNum = clauseId.replace('clause', '');
                const previewElement = document.getElementById(`preview-clause${clauseNum}`);
                
                if (userSelection === correctClauses[clauseId]) {
                    // Правильный ответ
                    correctCount++;
                    correctAnswers++;
                    statusElement.textContent = 'Верно';
                    statusElement.className = 'clause-status correct';
                    clause.classList.remove('incorrect');
                    
                    // Подсвечиваем правильные опции
                    clause.querySelectorAll('.clause-option').forEach(opt => {
                        if (opt.getAttribute('onclick').includes(`'${userSelection}'`)) {
                            opt.classList.add('correct');
                        } else {
                            opt.classList.remove('selected');
                        }
                    });
                    
                    // Зелёная подсветка в preview
                    previewElement.style.backgroundColor = 'rgba(39, 174, 96, 0.1)';
                } else {
                    // Неправильный ответ
                    statusElement.textContent = 'Неверно';
                    statusElement.className = 'clause-status incorrect';
                    clause.classList.add('incorrect');
                    
                    // Подсвечиваем правильные и неправильные опции
                    clause.querySelectorAll('.clause-option').forEach(opt => {
                        if (opt.getAttribute('onclick').includes(`'${correctClauses[clauseId]}'`)) {
                            opt.classList.add('correct');
                        } else if (opt.getAttribute('onclick').includes(`'${userSelection}'`)) {
                            opt.classList.add('incorrect');
                        }
                    });
                    
                    // Красная подсветка в preview
                    previewElement.style.backgroundColor = 'rgba(231, 76, 60, 0.1)';
                }
            }
            
            const resultDiv = document.getElementById('page5-result');
            
            if (!allSelected) {
                resultDiv.innerHTML = '<i class="fas fa-exclamation-circle"></i> Пожалуйста, выберите вариант для всех пунктов договора.';
                resultDiv.className = 'task-result error';
                return;
            }
            
            if (correctCount === 5) {
                resultDiv.innerHTML = '<i class="fas fa-check-circle"></i> Отлично! Вы правильно составили трудовой договор согласно требованиям ТК РФ.';
                resultDiv.className = 'task-result success';
                
                if (!answeredPages.has('page5')) {
                    answeredPages.add('page5');
                    score += 200; // Сложное интерактивное задание
                    
                    // Бонус за все правильные ответы
                    if (correctCount === 5) {
                        const bonus = 100;
                        score += bonus;
                        showBonusPopup(`Бонус +${bonus} очков за идеальный трудовой договор!`);
                    }
                    
                    document.getElementById('check-page5-btn').style.display = 'none';
                    document.getElementById('next-page5-btn').style.display = 'flex';
                    updateProgressDots();
                }
            } else {
                resultDiv.innerHTML = `<i class="fas fa-times-circle"></i> Правильно составлено ${correctCount} из 5 пунктов договора. Проверьте подсказки и попробуйте ещё раз.`;
                resultDiv.className = 'task-result error';
                
                // Показываем подсказки
                const hint = document.createElement('div');
                hint.style.marginTop = '15px';
                hint.style.padding = '15px';
                hint.style.backgroundColor = 'rgba(52, 152, 219, 0.1)';
                hint.style.borderRadius = '8px';
                hint.style.borderLeft = '4px solid #3498db';
                hint.innerHTML = '<h4><i class="fas fa-lightbulb"></i> Подсказка</h4>' +
                    '<p>Правильные ответы: 1-C (конкретная трудовая функция), 2-A (бессрочный договор - основной вид), ' +
                    '3-A (чёткий режим работы), 4-C (оклад + двухразовая выплата с указанием процентов), ' +
                    '5-A (28 дней отпуска по графику согласно ТК РФ).</p>';
                
                resultDiv.appendChild(hint);
            }
        }

        // --- Обработка ответов ---
        function selectOption(element, pageId, value) {
            document.querySelectorAll(`#${pageId} .option`).forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            selectedOptions[pageId] = value;
        }

        function toggleDocument(element, pageId, docId) {
            if (!selectedDocuments[pageId]) {
                selectedDocuments[pageId] = [];
            }
            
            const index = selectedDocuments[pageId].indexOf(docId);
            const icon = element.querySelector('.option-letter i');
            
            if (index === -1) {
                selectedDocuments[pageId].push(docId);
                icon.className = 'fas fa-check-square';
                element.classList.add('selected');
            } else {
                selectedDocuments[pageId].splice(index, 1);
                icon.className = 'far fa-square';
                element.classList.remove('selected');
            }
        }

        function checkAnswer(pageId, correctValue) {
            totalQuestions++;
            const selectedValue = selectedOptions[pageId];
            const resultDiv = document.getElementById(`${pageId}-result`);
            const optionElement = document.querySelector(`#${pageId} .option[onclick*="'${correctValue}'"]`);

            if (!selectedValue) {
                alert('Пожалуйста, выберите ответ.');
                return;
            }

            if (selectedValue === correctValue) {
                resultDiv.innerHTML = '<i class="fas fa-check-circle"></i> Верно! Вы отлично разбираетесь в теме.';
                resultDiv.className = 'task-result success';
                if (optionElement) optionElement.classList.add('correct');
                
                if (!answeredPages.has(pageId)) {
                    answeredPages.add(pageId);
                    score += 100;
                    correctAnswers++;
                    
                    if (totalTimeSeconds < 30 * answeredPages.size) {
                        const bonus = 25;
                        score += bonus;
                        showBonusPopup(`Бонус +${bonus} очков за быстрый ответ!`);
                    }
                    
                    document.getElementById(`check-${pageId}-btn`).style.display = 'none';
                    document.getElementById(`next-${pageId}-btn`).style.display = 'flex';
                    updateProgressDots();
                }
            } else {
                resultDiv.innerHTML = '<i class="fas fa-times-circle"></i> Неверно. Попробуйте ещё раз.';
                resultDiv.className = 'task-result error';
                document.querySelector(`#${pageId} .option.selected`).classList.add('incorrect');
                if (optionElement) optionElement.classList.add('correct');
            }
        }

        function checkDocumentsAnswer(pageId) {
            const correctDocs = ['claim', 'passport', 'order', 'workbook', 'contract', 'salary'];
            const resultDiv = document.getElementById('page6-docs-result');
            const selected = selectedDocuments[pageId] || [];
            
            if (!resultDiv) return;
            
            // Проверяем, все ли нужные документы выбраны
            const hasAllCorrect = correctDocs.every(doc => selected.includes(doc));
            // Проверяем, нет ли лишних документов
            const hasExtra = selected.some(doc => !correctDocs.includes(doc));
            
            if (hasAllCorrect && !hasExtra) {
                resultDiv.innerHTML = '<i class="fas fa-check-circle"></i> Отлично! Вы собрали полный пакет документов для подачи иска.';
                resultDiv.className = 'task-result success';
                resultDiv.style.display = 'block';
                
                // Даём бонус за правильный сбор документов
                if (!answeredPages.has('page6-docs')) {
                    answeredPages.add('page6-docs');
                    score += 50;
                    showBonusPopup('Бонус +50 очков за полный комплект документов!');
                }
                
                // Скрываем кнопку проверки
                document.getElementById('check-documents-btn').style.display = 'none';
            } else {
                resultDiv.innerHTML = '<i class="fas fa-exclamation-circle"></i> Не все документы отмечены или есть лишние. Проверьте список ещё раз.';
                resultDiv.className = 'task-result error';
                resultDiv.style.display = 'block';
            }
        }

        // --- Завершение квеста ---
        function completeQuest() {
            if (answeredPages.size >= 6) { // Все основные страницы + документы
                stopTimer();
                
                // Рассчитываем бонусы
                timeBonus = calculateTimeBonus();
                accuracyBonus = calculateAccuracyBonus();
                
                // Добавляем бонусы к общему счету
                score += timeBonus + accuracyBonus;
                
                // Обновляем финальный экран
                document.getElementById('final-score').textContent = score;
                
                const minutes = Math.floor(totalTimeSeconds / 60);
                const seconds = totalTimeSeconds % 60;
                document.getElementById('final-time').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                const accuracy = totalQuestions > 0 ? Math.round((correctAnswers / totalQuestions) * 100) : 100;
                document.getElementById('final-accuracy').textContent = `${accuracy}%`;
                document.getElementById('final-bonuses').textContent = timeBonus + accuracyBonus;
                
                // Устанавливаем дату в сертификате
                const now = new Date();
                document.getElementById('certificate-date').textContent = 
                    `${now.getDate().toString().padStart(2, '0')}.${(now.getMonth() + 1).toString().padStart(2, '0')}.${now.getFullYear()}`;
                
                // Показываем экран завершения
                document.getElementById(currentPage).classList.remove('active');
                document.getElementById('completion-screen').classList.add('active');
                currentPage = 'completion-screen';
                updateProgressDots();
                
                // Показываем итоговый бонус
                if (timeBonus + accuracyBonus > 0) {
                    setTimeout(() => {
                        showBonusPopup(`Итоговый бонус: +${timeBonus + accuracyBonus} очков!`);
                    }, 1000);
                }
            } else {
                alert('Вы не прошли все задания. Вернитесь и завершите их.');
            }
        }

        // --- Прогресс ---
        function updateProgressDots() {
            const dots = document.querySelectorAll('.progress-dot');
            const completed = answeredPages.size;
            
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index < completed);
            });
        }
    </script>
</body>
</html>
